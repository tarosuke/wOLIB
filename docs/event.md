# イベントについて

イベントには必ず以下の情報が含まれる。

- 時刻
- 種別

## ポインタイベント

マウスなどのポインティングデバイスによるイベント。イベント名の接頭辞は`p`。独自データは以下の通り。

- モディファイアフラグ
- 位置(事象が判明したときの座標、Paneローカル)
- Pane(内部的にはポインタ、通信するときにはID)
- ドラッグ元Pane

### pDown


## キーイベント

キー入力によるイベント。イベント名の接頭辞は`k`。独自データは以下の通り。

- モディファイアフラグ
- キーコード
- 文字コード

### 文字コードがある場合

キーイベントには文字コードとキーコードの両方を格納できるが、文字コードが存在する場合はキーコードは省略可能。その場合キーコードは0。だが実際にはキーコードがないのは合成されたイベントであろう。

### 文字コードがない場合

キーコードが格納される。文字コードは0。

## 一次イベント、二次イベント

`pDown`、`pUp`のような入力に一対一で対応しているイベントを一次イベント、`pClick`のように複数のイベントの組み立てや状況で生成されるイベントを二次イベントと呼ぶ。

|二次イベント|一次イベント||
|--|--|--|
|pClick|pDown → pUp|pDownとpUpの場所が同一Pane|
|pDrag|pDown → pMove|pMoveがpDown点より5px以上離れてから開始、以後pMoveごとに発生|
|pDrop|pDown → pMove → pUp|pDrag終了|
|pDragCancel|ドラッグ中にpUp / ESC|pDrag終了|
|pEnter|pMove|ポインタが何らかの形でPaneに入ったときに発生-位置はPane内|
|pLeave|pMove|ポインタが何らかの形でPaneから出たときに発生-位置はPane外|

実装上は一時イベントを二次イベント用のフィルタを通すことで二次イベントを発生させるような作りになる。なお、二次イベントが発生しても一次イベントは消費されず、イベントはそのまま流れる。


